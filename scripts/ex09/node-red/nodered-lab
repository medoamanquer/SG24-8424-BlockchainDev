[
    {
        "id": "a7146f7b.5571f",
        "type": "tab",
        "label": "Exercise 09",
        "disabled": false,
        "info": ""
    },
    {
        "id": "bad921e6.08a33",
        "type": "websocket in",
        "z": "a7146f7b.5571f",
        "name": "",
        "server": "a17028ac.be9388",
        "client": "",
        "x": 123,
        "y": 299,
        "wires": [
            [
                "3f228f51.733f98"
            ]
        ]
    },
    {
        "id": "aee9808.0f9f8",
        "type": "debug",
        "z": "a7146f7b.5571f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 583,
        "y": 219,
        "wires": []
    },
    {
        "id": "3f228f51.733f98",
        "type": "function",
        "z": "a7146f7b.5571f",
        "name": "Format Message",
        "func": "const e = JSON.parse(msg.payload);\nlet eventName = e.$class.split('.')[3];\n\nif (eventName === 'CancelOrderEvent') {\n    orderStatus = e.orderStatus;\n    orderId = e.order.orderId;\n    vehicle = e.order.vehicle.split('#')[1];\n    owner = e.order.owner.split('#')[1];\n    timestamp = new Date(e.timestamp);\n    msg.payload = `${eventName}: Order ${orderId} with VIN Number ${vehicle} and Owner ${owner} is ${orderStatus} on ${timestamp.toDateString()}`;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 383,
        "y": 299,
        "wires": [
            [
                "aee9808.0f9f8",
                "37ee8dc3.83160a"
            ]
        ],
        "inputLabels": [
            "msg"
        ]
    },
    {
        "id": "37ee8dc3.83160a",
        "type": "file",
        "z": "a7146f7b.5571f",
        "name": "Event Storage",
        "filename": "/tmp/events",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "x": 593,
        "y": 379,
        "wires": [],
        "inputLabels": [
            "msg.payload"
        ]
    },
    {
        "id": "61864973.328b3",
        "type": "inject",
        "z": "a7146f7b.5571f",
        "name": "Cancel Order",
        "topic": "",
        "payload": "{\"$class\":\"org.acme.vehicle_network.CancelOrder\",\"order\":\"org.acme.vehicle_network.Order#104\"}",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 80,
        "wires": [
            [
                "8a8f21ef.63f09"
            ]
        ]
    },
    {
        "id": "8a8f21ef.63f09",
        "type": "http request",
        "z": "a7146f7b.5571f",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "url": "http://localhost:3000/api/org.acme.vehicle_network.CancelOrder",
        "tls": "",
        "x": 330,
        "y": 80,
        "wires": [
            [
                "5f16a032.6a5488"
            ]
        ]
    },
    {
        "id": "5f16a032.6a5488",
        "type": "debug",
        "z": "a7146f7b.5571f",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 550,
        "y": 80,
        "wires": []
    },
    {
        "id": "dbcaee07.c1a2a8",
        "type": "comment",
        "z": "a7146f7b.5571f",
        "name": "Invoke Transaction",
        "info": "",
        "x": 290,
        "y": 140,
        "wires": []
    },
    {
        "id": "a9db858a.88503",
        "type": "comment",
        "z": "a7146f7b.5571f",
        "name": "Capture Events",
        "info": "",
        "x": 300,
        "y": 380,
        "wires": []
    },
    {
        "id": "a17028ac.be9388",
        "type": "websocket-listener",
        "z": "",
        "path": "ws://localhost:3000",
        "wholemsg": "false"
    }
]
